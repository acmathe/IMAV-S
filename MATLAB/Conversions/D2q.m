%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Conversion from attitude matrix to quaternion
%  Author: Davi A Santos/ITA, 26/01/2020
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function q = D2q(D)              
                
tr = trace(D);
n = 0.5*sqrt(1+tr);

e = 0.25/n*[D(2,3)-D(3,2);D(3,1)-D(1,3);D(1,2)-D(2,1)];

q = [e' n]';
                
